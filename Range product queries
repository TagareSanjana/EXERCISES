class Solution:
    def productQueries(self, n: int, queries: list[list[int]]) -> list[int]:
        MOD = 1_000_000_007
        MAX_BIT = 30  # Maximum bit for a 32-bit integer

        # Find the powers of 2 that constitute n
        pows = []
        for i in range(MAX_BIT):
            if (n >> i) & 1:  # Check if the i-th bit of n is set
                pows.append(1 << i) # Add 2^i to the list of powers

        ans = []
        for left, right in queries:
            prod = 1
            # Calculate the product of powers within the specified range
            for i in range(left, right + 1):
                prod = (prod * pows[i]) % MOD
            ans.append(prod)

        return ans
